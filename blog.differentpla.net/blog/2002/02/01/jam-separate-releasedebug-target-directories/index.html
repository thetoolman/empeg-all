<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width initial-scale=1" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Jam - Separate Release/Debug Target Directories</title>
<meta name="description" content="Jekyll sources for blog.differentpla.net">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"> 
<!-- theme is https://bootswatch.com/yeti/ -->
<link rel="stylesheet" href="../../../../../css/yeti/bootstrap.min.css">
<link rel="stylesheet" href="../../../../../css/yeti-custom.css">
<link rel="stylesheet" href="../../../../../css/site.css">

<link rel="canonical" href="index.html">
<link type="application/atom+xml" rel="alternate" href="../../../../../feed.xml" title="Roger's Blog" />
</head>


<body>

<div class="navbar navbar-inverse" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <ul class="nav navbar-nav navbar-left">
                <li><a class="navbar-brand" href="../../../../../index.html">Roger's Blog</a></li>
            </ul>
        </div>
    </div>
</div>



<div class="container">
    <article>
    <h1>Jam - Separate Release/Debug Target Directories</h1>
    <div class="details">
        <span class="created_at timeago" title="2002-02-01 12:05:00 +0000">2002-02-01 12:05:00 +0000</span>
        
    </div>
    <p></p>
    <p>By default, AppWizard-generated applications use separate directories for the output of the different debug and release builds. We’d like to replicate that functionality.</p>

<p>This is controlled by the <code class="highlighter-rouge">LOCATE_TARGET</code> variable. It’s initialised by the <code class="highlighter-rouge">SubDir</code> rule to be the same as the <code class="highlighter-rouge">SEARCH_SOURCE</code> variable, unless <code class="highlighter-rouge">ALL_LOCATE_TARGET</code> is set.</p>

<p>However, if we set <code class="highlighter-rouge">ALL_LOCATE_TARGET</code> to, e.g. <code class="highlighter-rouge">Debug</code> in our <code class="highlighter-rouge">Jamrules</code> file, or using the <code class="highlighter-rouge">-s</code> switch to jam, the object files and targets are all built in exactly the same directory. It’s not relative to the subdirectory. This could cause confusion if directories generate object files with the same names.</p>

<p>The comments in <code class="highlighter-rouge">Jambase</code> state that the <code class="highlighter-rouge">LOCATE_TARGET</code> variable should be set after invoking the <code class="highlighter-rouge">SubDir</code> rule, if required. This is a pain. We much prefer the following change to the <code class="highlighter-rouge">SubDir</code> rule:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>       # directory should not hold object files, LOCATE_TARGET can
       # subsequently be redefined.

       **local path = [ FDirName $(SUBDIR) $(TARGET_PREFIX) ] ;

       SEARCH_SOURCE = $(SUBDIR) ;
       LOCATE_SOURCE = $(ALL_LOCATE_TARGET) $(path) ;
       LOCATE_TARGET = $(ALL_LOCATE_TARGET) $(path) ;
       SOURCE_GRIST = $(path) ;**

       # Reset per-directory ccflags, hdrs
</code></pre></div></div>

<p>This allows us to place a rule like the following in our <code class="highlighter-rouge">Jamrules</code> file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if ! $(DEBUG) {
	ECHO Assuming DEBUG=1 ;
	DEBUG = 1 ;
}

if $(DEBUG) = 0 {
	TARGET_PREFIX = Release ;
}
else {
	TARGET_PREFIX = Debug ;
}
</code></pre></div></div>

</article>

</div>

<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-timeago/1.4.0/jquery.timeago.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
        $('.timeago').timeago();
        $('div.body > h1, h2, h3, h4, h5, h6').each(function(i) {
            $(this).append(
            '<a class="anchorlink" title="Link to ' +
                $(this).text() + '" href="index.html#' + $(this).attr('id') + '"></a>');
            });
        });
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40120477-1', 'auto');
  ga('send', 'pageview');

</script>
</body>

</html>
