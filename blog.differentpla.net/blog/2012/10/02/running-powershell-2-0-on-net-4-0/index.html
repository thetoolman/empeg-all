<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width initial-scale=1" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Running PowerShell 2.0 on .NET 4.0</title>
<meta name="description" content="Jekyll sources for blog.differentpla.net">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"> 
<!-- theme is https://bootswatch.com/yeti/ -->
<link rel="stylesheet" href="../../../../../css/yeti/bootstrap.min.css">
<link rel="stylesheet" href="../../../../../css/yeti-custom.css">
<link rel="stylesheet" href="../../../../../css/site.css">

<link rel="canonical" href="index.html">
<link type="application/atom+xml" rel="alternate" href="../../../../../feed.xml" title="Roger's Blog" />
</head>


<body>

<div class="navbar navbar-inverse" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <ul class="nav navbar-nav navbar-left">
                <li><a class="navbar-brand" href="../../../../../index.html">Roger's Blog</a></li>
            </ul>
        </div>
    </div>
</div>



<div class="container">
    <article>
    <h1>Running PowerShell 2.0 on .NET 4.0</h1>
    <div class="details">
        <span class="created_at timeago" title="2012-10-02 12:39:00 +0000">2012-10-02 12:39:00 +0000</span>
        
    </div>
    <p></p>
    <p>Attempting to use <code class="highlighter-rouge">Add-Type</code> to load a .NET assembly in PowerShell this afternoon, I got the following error:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>This assembly is built by a runtime newer than the currently loaded runtime
</code></pre></div></div>

<p>By default, PowerShell 2.0 runs using the v2.0 .NET runtime, and my assembly is built
against .NET 4.0. To get this to work, we need to persuade PowerShell to run on .NET 4.0</p>

<p>Note that PowerShell 3.0 uses the .NET 4.0 runtime, so you donâ€™t need to do anything.</p>

<p>The best way to do this is the <a href="http://stackoverflow.com/a/5069146/8446">second answer</a>
on this Stack Overflow question. In short, you add a <code class="highlighter-rouge">PowerShell.exe.config</code> file that loads .NET 4.0.</p>

<p>You can check that this has worked by looking at the <code class="highlighter-rouge">$PSVersionTable.CLRVersion</code> variable in PowerShell.</p>

</article>

</div>

<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-timeago/1.4.0/jquery.timeago.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
        $('.timeago').timeago();
        $('div.body > h1, h2, h3, h4, h5, h6').each(function(i) {
            $(this).append(
            '<a class="anchorlink" title="Link to ' +
                $(this).text() + '" href="index.html#' + $(this).attr('id') + '"></a>');
            });
        });
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40120477-1', 'auto');
  ga('send', 'pageview');

</script>
</body>

</html>
