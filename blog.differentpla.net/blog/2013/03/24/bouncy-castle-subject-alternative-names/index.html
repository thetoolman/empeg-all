<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width initial-scale=1" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Bouncy Castle - Subject Alternative Names</title>
<meta name="description" content="Jekyll sources for blog.differentpla.net">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"> 
<!-- theme is https://bootswatch.com/yeti/ -->
<link rel="stylesheet" href="../../../../../css/yeti/bootstrap.min.css">
<link rel="stylesheet" href="../../../../../css/yeti-custom.css">
<link rel="stylesheet" href="../../../../../css/site.css">

<link rel="canonical" href="index.html">
<link type="application/atom+xml" rel="alternate" href="../../../../../feed.xml" title="Roger's Blog" />
</head>


<body>

<div class="navbar navbar-inverse" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <ul class="nav navbar-nav navbar-left">
                <li><a class="navbar-brand" href="../../../../../index.html">Roger's Blog</a></li>
            </ul>
        </div>
    </div>
</div>



<div class="container">
    <div class="col-md-9">
    <article>
        <h1>Bouncy Castle - Subject Alternative Names</h1>
        <div class="details">
            <span class="created_at timeago" title="2013-03-24 14:20:58 +0000">2013-03-24 14:20:58 +0000</span>
        </div>
        <p></p>
        <p>When you connect to a server using HTTPS, the server provides a certificate that identifies it. Your browser will then typically check that the name in the server certificate matches the address that you’ve gone to. In this way, you can be sure that you’re connecting to the correct server.</p>

<p>Also, when you connect to a web server, you can use the <code class="highlighter-rouge">Host:</code> header to tell it which site you want to visit. In this way, multiple web sites can be hosted on a single IP address.</p>

<p>However, there’s a bit of a chicken-and-egg situation going on here: the server can’t read the <code class="highlighter-rouge">Host:</code> header until the SSL (actually TLS) session is established, it can’t establish the secure session without providing a server certificate, and it doesn’t know which certificate to provide until it’s seen the <code class="highlighter-rouge">Host:</code> header.</p>

<p>A bit of a quandary that one. There are a few ways around it:</p>

<h2 id="use-server-name-indication-sni">Use Server Name Indication (SNI)</h2>

<p>Server Name Indication is an extension to the TLS protocol that allows the client to indicate which server it’s trying to reach, in a similar way to the HTTP <code class="highlighter-rouge">Host:</code> header.</p>

<p>For this to work, your client needs to be using Internet Explorer 7 or later. I’ll assume that users who aren’t using IE are clued up enough to be using the latest and greatest Firefox, Chrome, Safari or whatever.</p>

<p>However, if you’re stuck with IIS on Windows, you need to be using IIS 8, which means Windows Server 2012.</p>

<h2 id="use-a-wildcard-certificate">Use a wildcard certificate</h2>

<p>This one’s easy: just issue a certificate for (e.g.) <code class="highlighter-rouge">CN=*.mydomain.com</code>. This certificate can then be used for any server in that domain (provided the certificate’s trusted, of course).</p>

<h2 id="use-a-subject-alternative-name-extension">Use a Subject Alternative Name extension</h2>

<p>In other places, you might see this referred to as a Universal Communication (UC) certificate. In short, it allows a certificate to have more than one subject name.</p>

<p>To add this extension, you need to use the following code:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var subjectAlternativeNames = new Asn1Encodable[]
    {
        new GeneralName(GeneralName.DnsName, "server"),
        new GeneralName(GeneralName.DnsName, "server.mydomain.com")
    };
var subjectAlternativeNamesExtension = new DerSequence(subjectAlternativeNames);
certificateGenerator.AddExtension(
    X509Extensions.SubjectAlternativeName.Id, false, subjectAlternativeNamesExtension);
</code></pre></div></div>

<p>Note that for this to work properly, you need to specify the value from the “Subject DN” property that you set earlier.</p>

    </article>
</div>
<div class="col-md-3">
    <ul class="nav series">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
            <li><a href="../../18/using-bouncy-castle-from-net/index.html">Using Bouncy Castle from .NET</a></li></li>
        
        
        
        
        
        
        
            <li><a href="../../18/how-do-i-convert-a-bouncy-castle-certificate-to-a-net-certificate/index.html">How do I convert a Bouncy Castle Certificate to a .NET Certificate?</a></li></li>
        
        
        
        
        
            <li><a href="../../20/bouncy-castle-missing-certificate-attributes/index.html">Bouncy Castle - Missing Certificate Attributes</a></li></li>
        
        
        
        
        
            <li><a href="../../23/bouncy-castle-extended-key-usage/index.html">Bouncy Castle - Extended Key Usage</a></li></li>
        
        
        
        
        
            <li class="active"><a href="index.html">Bouncy Castle - Subject Alternative Names</a></li>
        
        
        
        
        
            <li><a href="../bouncy-castle-being-a-certificate-authority/index.html">Bouncy Castle - Being a Certificate Authority</a></li></li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    </ul>
</div>

</div>

<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-timeago/1.4.0/jquery.timeago.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
        $('.timeago').timeago();
        $('div.body > h1, h2, h3, h4, h5, h6').each(function(i) {
            $(this).append(
            '<a class="anchorlink" title="Link to ' +
                $(this).text() + '" href="index.html#' + $(this).attr('id') + '"></a>');
            });
        });
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40120477-1', 'auto');
  ga('send', 'pageview');

</script>
</body>

</html>
