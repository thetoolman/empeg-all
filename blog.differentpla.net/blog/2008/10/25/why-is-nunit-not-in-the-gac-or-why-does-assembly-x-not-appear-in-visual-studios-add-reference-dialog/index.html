<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width initial-scale=1" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Why is NUnit not in the GAC? (or Why does [assembly X] not appear in Visual Studio's Add Reference dialog?)</title>
<meta name="description" content="Jekyll sources for blog.differentpla.net">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"> 
<!-- theme is https://bootswatch.com/yeti/ -->
<link rel="stylesheet" href="../../../../../css/yeti/bootstrap.min.css">
<link rel="stylesheet" href="../../../../../css/yeti-custom.css">
<link rel="stylesheet" href="../../../../../css/site.css">

<link rel="canonical" href="index.html">
<link type="application/atom+xml" rel="alternate" href="../../../../../feed.xml" title="Roger's Blog" />
</head>


<body>

<div class="navbar navbar-inverse" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <ul class="nav navbar-nav navbar-left">
                <li><a class="navbar-brand" href="../../../../../index.html">Roger's Blog</a></li>
            </ul>
        </div>
    </div>
</div>



<div class="container">
    <article>
    <h1>Why is NUnit not in the GAC? (or Why does [assembly X] not appear in Visual Studio's Add Reference dialog?)</h1>
    <div class="details">
        <span class="created_at timeago" title="2008-10-25 10:58:08 +0000">2008-10-25 10:58:08 +0000</span>
        
    </div>
    <p></p>
    <p>Because Visual Studio doesn’t look for references in the GAC:</p>

<ul>
  <li><a href="http://blogs.msdn.com/msbuild/archive/2007/04/12/new-reference-assemblies-location.aspx">http://blogs.msdn.com/msbuild/archive/2007/04/12/new-reference-assemblies-location.aspx</a></li>
  <li><a href="http://blogs.msdn.com/junfeng/archive/2004/03/22/93708.aspx">http://blogs.msdn.com/junfeng/archive/2004/03/22/93708.aspx</a></li>
</ul>

<p>This is by design.</p>

<p>You can either add your files explicitly, which doesn’t work if other people in your team have installed the files somewhere else, for example <code class="highlighter-rouge">C:\Program Files\NUnit 2.4.6</code> vs. <code class="highlighter-rouge">C:\Program Files\NUnit-2.4.6</code>. Or <code class="highlighter-rouge">C:\Program Files\NUnit 2.4.6</code> vs. <code class="highlighter-rouge">C:\Program Files (x86)\NUnit 2.4.6</code>.</p>

<p>You have a couple of options:</p>

<ul>
  <li>If your assemblies don’t already have homes, you can put them in the VS <code class="highlighter-rouge">PublicAssemblies</code> folder: <a href="http://blogs.msdn.com/csharpfaq/archive/2004/10/20/245239.aspx">http://blogs.msdn.com/csharpfaq/archive/2004/10/20/245239.aspx</a></li>
  <li>If they already have homes, you can add them to the <code class="highlighter-rouge">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\AssemblyFolders</code> registry key: <a href="http://support.microsoft.com/?kbid=306149">http://support.microsoft.com/?kbid=306149</a>.</li>
  <li>If you’re developing assemblies for other developers to use (i.e. you’re Microsoft or a development tool vendor), you can put these in a subdirectory of <code class="highlighter-rouge">C:\Program Files\Reference Assemblies directory</code>, and then add that to the <code class="highlighter-rouge">AssemblyFolders</code> registry key.</li>
</ul>

<p>This means that your project files will reference the assembly by name (i.e. name, version, public key token, all that jazz), and it won’t matter where it’s actually installed on your PC.</p>

<p>Note, however, that this doesn’t work as-is on 64-bit, because Visual Studio is a 32-bit application. You actually need to register your stuff under <code class="highlighter-rouge">HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\.NETFramework\AssemblyFolders</code>, and you should probably register under both.</p>

<p>There are also corresponding <code class="highlighter-rouge">HKEY_CURRENT_USER</code> variants of those keys, but (since that roams), it’s not much use (because the paths are usually relative to the machine, anyway).</p>

</article>

</div>

<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-timeago/1.4.0/jquery.timeago.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
        $('.timeago').timeago();
        $('div.body > h1, h2, h3, h4, h5, h6').each(function(i) {
            $(this).append(
            '<a class="anchorlink" title="Link to ' +
                $(this).text() + '" href="index.html#' + $(this).attr('id') + '"></a>');
            });
        });
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40120477-1', 'auto');
  ga('send', 'pageview');

</script>
</body>

</html>
