
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
	<title>rio car dot org</title>
	<base href="">
	<link rel="StyleSheet" href="themes/Default/style/style.css" type="text/css">
</head>

<body background="themes/RioCar2/images/outer_bg.gif" bgcolor="#FFFFFF" text="#000000" topmargin="0" bottommargin="0" leftmargin="0" rightmargin="0" marginheight="0" marginwidth="0" link="#00093C" vlink="#00093C" alink="#0000FF">
<table border="0" cellspacing="0" cellpadding="0" width="100%" bgcolor="#000D52" style="border-collapse: collapse" bordercolor="#111111" background="themes/RioCar2/images/header_bg.gif">
<tr>
<td><img border="0" src="themes/RioCar2/images/logo.gif" width="270" height="90" Alt="Welcome to "></td>
<td align="right"><img border="0" src="themes/RioCar2/images/header_mk2fade.gif" hspace="5" width="264" height="90"></td>
</tr>
</table>
<table border="0" cellspacing="0" width="100%" bgcolor="#666666" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">
<tr>
<td><font color="#FFFFFF">&nbsp;<b><font size="2" face="Verdana">Welcome to riocar.org!</font></b></font></td>
<td align="right"><font color="#FFFFFF"><font face="Verdana" size="2"><b>Friday, August 6th</b></font>&nbsp;</font></td>
</tr>
</table>
<table border="0" cellspacing="0" width="100%" bgcolor="#000000" cellpadding="0">
<tr>
<td width="100%">
<img border="0" src="themes/RioCar2/images/clear.gif" width="1" height="1"></td>
</tr>
</table>
<TABLE><TR><TD VALIGN="TOP"><table border="0" cellspacing="0" cellpadding="0" width="150" bgcolor="000000"><tr><td><table width="100%" border="0" cellspacing="1" cellpadding="3"><tr><td bgcolor="666699" ><font class="contentheader" color=ffffff>Main Menu</font></td></tr><tr><td bgcolor="ffffff"><font class="content"><font class="content">
<strong><big>&middot;</big></strong>&nbsp;Web Links<br>
<strong><big>&middot;</big></strong>&nbsp;Downloads<br>
<strong><big>&middot;</big></strong>&nbsp;<a href="http://empegbbs.com">BBS/Forums</a><br>
<strong><big>&middot;</big></strong>&nbsp;<a href="lens.html">Lens Compare</a><br>
<strong><big>&middot;</big></strong>&nbsp;Boot Logos<br>
<strong><big>&middot;</big></strong>&nbsp;<a href="Button_Guide.html">Button Guide</a><br>
<strong><big>&middot;</big></strong>&nbsp;<a href="Developer_Info.html">Developer Info</a><br>
<strong><big>&middot;</big></strong>&nbsp;<a href="Drive_Upgrade.html">Drive Upgrade</a><br>
<strong><big>&middot;</big></strong>&nbsp;<a href="FAQ.html">FAQ</a><br>
<strong><big>&middot;</big></strong>&nbsp;<a href="Geek_Guide.html">Geek Guide</a><br>
<strong><big>&middot;</big></strong>&nbsp;Photo Gallery<br>
</font></font></td></tr></table></td></tr></table><br><table border="0" cellspacing="0" cellpadding="0" width="150" bgcolor="000000"><tr><td></td></tr></table><br><img src="images/pix.gif" border="0" width="150" height="1"></td><td>&nbsp;&nbsp;</td><td width="100%" valign="top">
<table border="0" cellspacing="0" cellpadding="0" bgcolor="#000000"><TR><TD>

<table width="100%" border="0" cellspacing="1" cellpadding=20><TR><TD bgcolor="#ffffff" >



<FONT color="000000" face="Arial, Helv, Helvetica">
<CENTER>

<table border=0 cellpadding = 0 width= 330><TR><TD>

<center><img src="modules/Drive_Upgrade/drive_01.jpg" border=0></center></td></tr><tr><td>

<font class=size5 size=5 face="Arial, Helv, Helvetica"><center><B>Rio Car Disk Upgrade Guide</B></font><br><font class=size1 size=1><br>

<i>Text by Tony Fabris, based on information from <br><a href="http://www.empeg.com">empeg</a> and the <a href="http://empeg.comms.net">empeg BBS</a>.</i>

<br>
<i>Photos courtesy of Dan Wallach and Rod Little.</i>

<br>

<i>Movie files courtesy of David Moss</i>

</font></center>

</td></tr></table>

</CENTER>


<BR><BR>


<font size="2" face="Verdana, Arial, Helv, Helvetica">


<center><table border=0 cellpadding = 23 BACKGROUND="modules/Drive_Upgrade/warnbox1.gif" width= 340 height=180><TR><TD><center><font face="Arial, Helv, Helvetica" class=size2 size=2>

<B>WARNING:</B><BR></center>
If you open your player to upgrade the disk drives, it will void your warranty. There is a real possibility that you could damage the unit if you perform the procedure incorrectly or clumsily. Because of the shock-mount cradle, the fragile display board, and the limited clearances inside the case, it's not as simple as upgrading a computer's hard disk.

</font></TD></TR></table></center><BR><BR>

</font>

<font size="2" face="Verdana, Arial, Helv, Helvetica"><B><I>Upgrade Preparation</B></I><BR><BR>

There are a few questions you need to ask yourself as you prepare for the upgrade:
<UL><LI>Do I own a Mark 1 or a Mark 2?<BR><BR>

<font class=size1 size=1><b><i>If adding a drive to a Mark 1, you'll need to pre-order a special kind of IDE cable.</i></b></font></LI><BR><BR>

<LI>What kind of disk drives will fit in my player?<BR><BR>

<font class=size1 size=1><b><i>Mark 1 and mark 2 players have different clearances.</i></b></font></LI><BR><BR>


<LI>How big do I want to go?<BR><BR>

<font class=size1 size=1><b><i>There are some limitations that you might need to work around, described below.</i></b></font></LI><BR><BR>


<LI>Right now, does my player have one hard disk or two?<BR><BR>

<font class=size1 size=1><b><i>Is there room for a second disk, or will you have to juggle drives?</i></b></font></LI><BR><BR>


<LI>Do I want to keep the primary disk drive and add a second drive?<BR><BR>

<font class=size1 size=1><b><i>Adding a second drive is fairly simple.</i></b></font></LI><BR><BR>


<LI>Do I want to replace the primary disk drive?<BR><BR>

<font class=size1 size=1><b><i>Replacing the primary drive is complicated if you want to keep the music on it.</i></b></font></LI></UL>



<BR><B><I>Selecting a disk drive:</B></I><BR><BR>

The player accepts industry-standard 2.5" <b><i>laptop IDE</b></i> hard disks. They must be laptop drives, not the bigger 3.5" desktop drives. They must also be IDE hard disks rather than SATA hard disks. Another limitation is the <b><i>height</b></i> of the disk drive. There's a limited amount of vertical clearance in the player case, and the shock-mount cradle needs a little room to move.<BR><BR>


<center><table border=0 cellpadding=5 width=310 ><TR><TD valign=top><img src="modules/Drive_Upgrade/mark1.gif" border=0 alt="Mark 1" ></td><td valign=top><font size="2" face="Verdana, Arial, Helv, Helvetica">
For the empeg Mark 1, the drive must be no taller than <font color=blue><b>14 millimeters</b></font>.
</FONT></TD></TR></TABLE><BR>

<table border=0 cellpadding=5 width=310  ><TR><TD valign=top><img src="modules/Drive_Upgrade/mark2.gif" border=0 alt="Mark 2" ></td><td valign=top><font size="2" face="Verdana, Arial, Helv, Helvetica">
For the empeg Mark 2 and the Rio Car, the drive must be no taller than <font color=blue><b>19.5 millimeters</b></font></font>.
</FONT></TD></TR></TABLE></center><BR>

</font><font size="2" face="Verdana, Arial, Helv, Helvetica">

Disk drive access speed isn't a factor, since the player uses an aggressive caching algorithm that leaves the disks spun down most of the time. Any modern laptop hard disk should be fast enough, and you will not notice any speed increase by purchasing a faster disk drive. In fact, if choosing between a fast drive and a slower drive, the slower drive is probably the better choice because it will most likely be cheaper and produce less heat. Your biggest concern will be the price/capacity trade-off. <br><br>

How much you spend on a new hard disk is totally up to you. Some people like to use <a href="http://www.pricewatch.com" target=_new>Pricewatch</a> or one of the online auction sites to locate good deals on hard disks. Buyer beware, however, some of the outfits hawking their wares on these sites can be a little shady. You might want to make sure you're getting a full manufacturer's warranty on the disk drives before making a purchase.<BR><BR>

Although nearly any IDE laptop drive should work, there have been some reports of compatibility problems when mixing two dissimilar drives in a Mark 2 unit. One report was of a Toshiba drive which refused to be a slave to an IBM drive. Another report was of an IBM 48gb drive that wouldn't work in the same player as an IBM 10gb drive, regardless of the master/slave order. Another possible compatibility problem is if there's an extreme difference in spin-up time between the two drives, it might cause the second drive to time out if it takes too long. So you may want to consider installing your drives as a matched pair. This isn't strictly necessary, and if you're lucky, you might be able to work around these kinds of problems simply by swapping the drive order. Also there have been reports of certain drives which aren't properly being detected as being the master drive in a single-drive configuration. Details of the problem and the work-around are posted <a href="http://empeg.comms.net/php/showflat.php?Cat=&Board=empeg_tech&Number=184235">here</a>. <BR><BR>

The maximum disk drive size allowed by the player's original Linux kernel is 128gb per disk drive. If you have a hard disk larger than this, you will need to install the latest <a href="http://www.riocar.org/modules.php?op=modload&name=FAQ&file=index&myfaq=yes&id_cat=11&categories=Hijack+Kernel+Questions">Hijack Kernel</a> on top of the regular kernel in order for large drives to work. Also, the official empeg disk builder images have not been upgraded to support large drives, and tend to crash if the hard disk is bigger than about 60 gigs. Work arounds to this problem are covered in the appropriate section of this guide. The work arounds are mostly specific to Mark 2 players, so if you are trying to upgrade a Mark 1 player, you might want to consider keeping your disk drive sizes under 60gb.<BR><BR>

Something else to think about: Even if you do successfully install high capacity disks into the player, you might run into some limitations when you start filling those disks with songs. The player has a limited amount of RAM for caching the database of songs. Players with too many songs on the hard disk (between 10,000 and 20,000 depending on the amount of data in their tags) will hit the database size limit and will have trouble indexing the entire player contents all at once. This can be worked around by manually rebuilding the database when you add new music, and dividing the music up into smaller sub-playlists and playing only those on playback. There are also other tricks you can do that can increase those limitations, discussed in detail <a href="http://empegbbs.com/ubbthreads.php/ubb/showflat/Number/306495">here</a>.<br><br>

<BR><B><I>Besides the disk drive, what else do I need?</B></I><BR><BR>

<UL><LI>In addition to the drive height limitation listed above, there is another important difference between the two models of player. The Mark 1 has two separate IDE connectors on the motherboard, the Mark 2 has a single IDE connector with a two-head cable.<BR><BR>


<table border=0 cellpadding=5 ><TR><TD valign=top><img src="modules/Drive_Upgrade/mark1.gif" border=0 alt="Mark 1" ></td><td valign=top><font size="2" face="Verdana, Arial, Helv, Helvetica">
If you will be adding a second disk drive to the Mark 1, you will need to purchase a proper IDE connector cable. Not just any cable will do, it must be the proper length. There's very little room inside the case, and if you get a cable that's too long, you'll damage the components trying to cram the cable in there. The correct cable can be purchased from <a href="http://www.videk.co.uk" target=_new>Videk</a>, part #3017.
</FONT></TD></TR></TABLE><BR>

<table border=0 cellpadding=5 ><TR><TD valign=top><img src="modules/Drive_Upgrade/mark2.gif" border=0 alt="Mark 2" ></td><td valign=top><font size="2" face="Verdana, Arial, Helv, Helvetica">If you're adding a second disk drive to the Mark 2, it's a lot easier because the Mark 2 has a single cable with two connectors, and the cable is already there waiting for you. However, you'll need to configure the disk drives in an IDE master/slave configuration, which will probably require a jumper to be installed on some pins on the second disk drive. Consult the manual that came with your new drive for instructions on how to properly set it as a slave using a jumper.<BR><BR>

If required, this jumper should be included with the new drive. If it isn't, you'll have to scrounge one, find some at a local computer store, or order some. Note that it must be the correct size jumper, which is 2mm. If you use the wrong size jumper, for example, if you use a 2.54mm jumper, you might get intermittent problems where the jumper loses contact because the grippers on the jumper are too large for the pins on the disk drive. According to Hugo, the correct jumpers are sold by <a href="http://www.farnell.com" target=_new>Farnell</a>, part numbers 510920 (blue), 510932 (black) and 510944 (red). For the US, the <a href="http://www.jameco.com" target=_new>Jameco</a> part number is reportedly 119263. </FONT></TD></TR></TABLE><BR></LI>

</font><font size="2" face="Verdana, Arial, Helv, Helvetica">

<LI>Some electrical tape will be needed to insulate the drive cradle from the components on the bottom of the disk drive.</LI><BR><BR>

<LI><img src="modules/Drive_Upgrade/drive_02.jpg" border=0 align=right vspace=5 hspace=10>You'll also need four screws to secure the drive to the shock-mount cradle. These screws are pretty standard disk-mounting screws (some might have even been included with your new disk drive), but remember that they have to be the correct thread (M3), the correct length (short), and their heads have to be fairly low-clearance so they don't bump the components on the motherboard. If you're a hardware hacker, you probably already have some lying around that will work. If not, try local computer stores, bringing in one of the original screws for reference. <blockquote><font class=size1 size=1>(Don't tell anyone I said this, but in a pinch, you could steal two diagonal screws from the first hard disk to secure the second one. If you do, make sure to get some of the right screws and finish the job as soon as you can.)</font></blockquote></LI>

<LI>You'll need a set of washers to raise the drives above the drive cradle so that there's no risk of pressure on the drive spindle. This was recently discovered to be necessary for some drives (the IBM DJSA-220 in particular), but in this guide I will recommend installing the washers on all drives to make absolutely sure that it's been taken care of in all cases. Even if your original drive came without washers, you should install them. The exact size of the washers is not critical as long as they fit around the screws and do not touch any of the components on the bottom of the drive.<blockquote><font class=size1 size=1><i>Note:</i> Depending on the player configuration and the type of washers you get, you may need to compensate by getting slightly longer screws.</font></blockquote></LI>

<LI>You'll need to have Hyperterminal prepared to connect to the player's serial port. Complete instructions for this are located in the <a href="http://www.riocar.org/modules.php?op=modload&name=FAQ&file=index&myfaq=yes&id_cat=7&categories=Upgrade%2C+customization%2C+and+third-party+software+questions&faqent=82#82" target=_new>Customization section of the FAQ</a>. Make sure your serial connection works and you can see the player's output in Hyperterminal before starting.</LI><BR><BR>

<LI><s>You'll need to get the Disk Builder utility upgrade from the <a href="http://www.empeg.com/support.html" target=_new>Support section of the empeg web site</a>. Make sure to get the proper one for your player (Mark 1 or Mark 2), and use the latest version.<b><i>Note:</i></b> Do not attempt to run this file now! It will format whatever hard disk is plugged in.</LI></s> <BR><BR>

<LI>On second thought, don't bother with the official empeg version of the disk builder any more. If you are working with large hard disks (40-60 gigs or larger), then the official empeg disk builder doesn't work, and if you're working with small disks, it doesn't hurt to use the bigdisk version. So instead, grab a copy of <a href="http://rtr.ca/bigdisk">Mark Lord's Special Disk Builder</a>, which should work with any size disk drives. <b><i>Note:</i></b> Do not attempt to run this file now! It will format whatever hard disk is plugged in.</LI><BR><BR>

<LI>You will need to re-install the player software upgrade onto the new disk drive after formatting it, so make sure you also have an installer ready for that. Your best choice is the <a href="http://rtr.ca/bigdisk">2.01 Final Software Installer for Large Disks</a> even if your disk is a small one, since it works with all disk sizes.  Make sure that it is the correct one for your player model (Mark 1 or Mark 2). If necessary, upgrade your current player software before starting this procedure to make certain that it's the same one as what you'll be installing on the new disk. This is important, so that a mismatch between the flash kernel and the player on the disk doesn't happen as you swap disks.</LI><BR><BR>

<LI>If you have a Mark 1 player, there isn't a bigdisk version of the full player installation available. Instead, download <a href="http://www.empeg.com">the official empeg player software installer</a> (Mark1, 2.01 final, developer version) and be ready to put the latest Hijack onto the player as soon as the upgrade is complete. At the time of this writing, there isn't an easy solution for disks 160GB or larger in a Mark 1 player, so keep your disks under 160 on Mark 1's.</LI><br><br>

<LI>Have your original power supply (the one you got with your player) ready to use. If you are using a third-party power supply, it might have been adequate for a single-disk player but not for a two-disk player. Just to be on the safe side, use the original power supply during the upgrade so that it doesn't fail with a voltage under-run at a crucial moment.</LI><BR><BR>

<LI>You will need a properly-sized Phillips-head screwdriver to loosen the screws that hold the shock mount tray in place. Your best bet is to use a screwdriver with a set of interchangeable heads and a large handle. A set of small "jeweler's screwdrivers" might be the correct size, but the lack of a large handle means that you might not be able to apply enough torque to loosen the screws. </LI><BR><BR>

<LI>If you're a Mark 2 owner, you'll need a 2.5mm hex tool to remove the faceplate.</LI></UL>


<BR><B><I>Adding a second drive or replacing the primary drive?</B></I><BR><BR>

By far, it's much easier to add a second drive than it is to replace the first drive. When done properly, the second drive simply appears as extra capacity on the player, and there's no need to move files or do anything special to get the player to recognize it. All that needs to happen is that the second drive needs to be formatted (more on this later).<BR><BR>

Replacing the primary disk drive is similar to adding a second disk drive, but there are some extra steps involved if you want to preserve the existing files and playlists. You install both drives, then use the Linux command prompt to copy the song files from the old drive to the new drive.<BR><BR>

If you are replacing one or both drives in a two-drive unit, or you're doing some other kind of complex upgrade, you'll probably need to play a game of Musical Drives as you format, swap, and copy your files among the drives. Use the instructions below as a general guide, and do your best to keep track of which drives are which. Use caution not to accidentally format a drive which contains MP3 files you don't want to lose.<BR><BR>

<BR><B><I>Step 1: Open the player</B></I><BR><BR>

<table border=0 cellpadding=5 ><TR><TD valign=top><img src="modules/Drive_Upgrade/mark1.gif" border=0 alt="Mark 1"></TD><TD valign=top><font size="2" face="Verdana, Arial, Helv, Helvetica">

Unplug the player. Remove the four screws on the top and lift off the cover, breaking the warranty seals if necessary. Do not touch the display board at the front of the unit.
</FONT></TD></TR></TABLE><BR>


<table border=0 cellpadding=5 ><TR><TD valign=top><img src="modules/Drive_Upgrade/mark2.gif" border=0 alt="Mark 2"></TD><TD valign=top><font size="2" face="Verdana, Arial, Helv, Helvetica">

<img src="modules/Drive_Upgrade/drive_03.jpg" border=0 align=right vspace=5 hspace=10>Unplug the player. Use the 2.5mm hex tool to unscrew the four bolts and remove the fascia. Pull the volume knob off its shaft, then remove the transparent faceplate. Use caution: The inner surface of the transparent faceplate has a special EMF coating. Be careful to lay the part face down so you don't scratch it. Put the four buttons and the knob in a safe place.<BR><img src="modules/Drive_Upgrade/drive_04.jpg" border=0 vspace=5 hspace=10><BR><BR>

The top lid slides forward and is connected by tab-and-groove bits. Break the warranty seal if necessary.

<blockquote><B><I>Note:</B></I> Make sure to extend the carrying handle so that the sled-grip hooks don't get in the way as you try to remove the lid.</blockquote>

It's a tight fit as the front tabs travel over the corresponding tabs on the main case, and levering them slightly upwards with a screwdriver is usually necessary. Be careful not to let the screwdriver damage the sled hooks or anything else inside the case.<BR><BR>

<a href="upload/faqpics/remove_fit_lid.mpg">Click here to view a video file (3.17mb mpeg)</a> of how to remove the lid without damaging it. <a href="modules/Drive_Upgrade/empeg_dismantle.mpeg">Click here to view a video file (525k mpeg)</a> of a close up of how to lever the corner tabs near the sled hooks. <I><B><font class=size1 size=1>Videos courtesy of David Moss and Marcus Wakefield.  </font></B></i><BR><BR>

Be very careful not to bump the display board as you do this, and do not attempt to remove the display board for any reason. This procedure can be completed with the display board in place.
</FONT></TD></TR></TABLE><BR>

</font><font size="2" face="Verdana, Arial, Helv, Helvetica">

<BR><B><I>Step 2: Remove the shock-mount cradle</B></I><BR><BR>

<img src="modules/Drive_Upgrade/drive_05.jpg" border=0 align=right vspace=5 hspace=10>You should now be able to see which four screws on the player's outer sides are the ones holding the tray assembly in place. Remove these four screws.<BR><BR>

On some players, you may find the warranty seals here on the tray assembly. Break these seals if necessary.<BR><BR>

Check to make sure that the tray assembly isn't stuck to the sides of the player. Some players were assembled with an excess of thread-lock compound on the tray screws, causing the mounts to be stuck to the sides of the casing. You should be able to gently flex the sides of the casing or pry at the side rails so that the assembly is loosened from the case. Don't try to pull on the tray assembly until you're sure that the side rails are loosened from the casing sides.<BR><BR>

<img src="modules/Drive_Upgrade/drive_06.jpg" border=0 align=right vspace=5 hspace=10>Now lift the tray assembly out of the case <b><i>gently</b></i>. If you encounter resistance, you are doing it wrong. Make sure that no part of the drives, cables, or cradle are hanging up on any components inside the case. If you break a component off of the display board by trying to yank the tray out of the case, you will make Support very angry.<BR><BR>

<a href="upload/faqpics/remove_drive_tray.mpg">Click here to view a video file (4.17mb mpeg)</a> of the procedure for removing the drive tray. Note where David points to the component that tends to get broken off if you do this procedure incorrectly.<br><br>

If the rubber shock mounts have come undone from the assembly, we'll deal with them later. Just carefully remove the entire tray assembly.<BR><BR>

Also, at no point should you attempt to remove the display board at the front of the unit. If you do, you run the risk of blowing several components on reassembly. <i><b>Leave the display board alone, please.</i></b><BR><BR>

Once the cradle is free, carefully note how the IDE cable is connected at both ends, using the stripe on the cable for reference. Make sure you know which pins are covered by the connector and which ones are not. Be very careful about this. when you re-assemble, it's very easy to get the connector mis-aligned by one pin. On some drives, the connector will seem to "fit" even if it's off by one pin.<BR><BR>

Also make sure to note the orientation of the disk drive tray assembly i.e., which side points forward. There should be notches on the front ends of the side rails which correspond to the docking sled grip-hooks. And also note the orientation of the disk drives themselves in relation to the tray; the IDE connectors point toward the front of the player. When you re-assemble, it's critical to have all of these items oriented correctly.<br><br>

<BR><B><I>Step 3: Disconnect the IDE cable</B></I><BR><BR>

<B><I>Do not try to unplug the IDE cable yet.</b></i> Instead, carefully unscrew the drive from the tray so that you can easily get to its underside. Set the tray assembly aside.<BR><BR>

<blockquote><img src="modules/Drive_Upgrade/drive_07.jpg" border=0 align=right vspace=5 hspace=10><i><b>Note:</b></i> If you've got a Mark 2 manufactured after 8-14-2000, disconnecting the IDE cable will probably involve removing the strip of hot-melt glue they used to keep it connected during shipping. The glue is most likely on the underside of the drive, and it will take some careful work to remove it. Make sure not to damage the drive circuitry or the cable as you're removing the glue. Do not attempt to pull the cable off of the drive until you are sure there's no glue, or the glue has been removed. <a href="upload/faqpics/remove_drive_glue.mpg">Click here to view a movie file of the procedure (4.2mb mpeg)</a>.</blockquote>

Now carefully unplug the IDE cable. Use caution not to rip apart the connector block in the process, this will damage the cable and cause drive errors, requiring cable replacement.<BR><BR>

From this point on, you need to be absolutely clear about which drive is which (old and new). If necessary, use a sticky-note to clearly label the original drive. Now set it aside somewhere safe, we'll get back to it later.<BR><BR>

<blockquote><B><I>Note:</i></b> Most laptop disk drives will make a rattling noise if you shake them. This is normal. Do not panic if you hear a rattle while you are handling the loose disk drives.</blockquote>

<BR><B><I>Step 4: Inspection and repair</B></I><BR><BR>

<img src="modules/Drive_Upgrade/drive_08.jpg" border=0 align=right vspace=5 hspace=10>On some players, you might find a small wire wedged between the disk drive pins and the IDE connector. This is to prevent the connector from being damaged by being squeezed on too far. If the loose wire makes you uncomfortable, you can discard it as long as you remember not to push the connector on too hard and damage it.<BR><BR>

Inspect the IDE cable and make sure it's OK. On some early Mark 1 models, a messy solder on a jumper on the motherboard might have scarred the cable. Repair this as necessary. In my case I had to file down the jumper, resolder it, and protect the damaged cable with electrical tape. If you have to do this, use extreme caution and don't let any filings stay inside the case.<BR><BR>

<img src="modules/Drive_Upgrade/drive_09.jpg" border=0 align=right vspace=5 hspace=10>Inspect the shock-mount tray assembly and make sure the rubber shocks have not popped out of the tray mounts. The Mark 1 units are more susceptible to this problem than the Mark 2 units. If they have come undone, pop them back in and use some RTV silicone glue to help them stay in place more permanently.<BR><BR>

Make sure the bare surface of the drive tray is properly insulated in both drive spots. Most likely, you'll see some strips of electrical tape where the original drive used to be. If the second drive spot is bare, use electrical tape to insulate it in a similar fashion. Don't apply the tape too thickly or it will press against the bottom of the disk drive (a bad thing). When I did it, I made sure that the edges of the tape lined up exactly and did not overlap. Also make sure not to cover the mounting points (screw holes) with tape.<BR>
<img src="modules/Drive_Upgrade/drive_10.jpg" border=0 vspace=5 hspace=10>

<BR><BR>


<BR><B><I>Step 5: Connecting the new drive</B></I><BR><BR>

Plug in the new drive just like the old one was. Plug in <i>only</i> the new drive, keep the old one at a safe distance.<BR><BR>

Use extreme care in connecting the IDE cable to the drive. It's easy to mis-align the connector since laptop drives don't have the "keeper shroud" that prevents you from plugging the connector on wrong. Most drives will let you plug it in "wrong" by one pin-position, and unless you look closely, it might look like it was plugged in "right".<BR><BR>

<img src="modules/Drive_Upgrade/drive_11.jpg" border=0 align=right vspace=5 hspace=10>For the formatting stage, you don't need to screw the new drive into the cradle unless you want to. The IDE cable should be long enough for you to format the drive when it's loosely tethered. Make sure you're not getting any metal contact with any electronic components, either on the bottom of the drive or in the player's innards. You might need to use a CD jewel case or a bit of folded paper to keep the drive from making contact. Don't plug the power cable into the player just yet.<BR><BR>

<BR><B><I>Step 6: Formatting the new drive</B></I><BR><BR>

In just a moment, you will be installing the Disk Builder upgrade software. The Disk Builder upgrade file is a special kernel that does nothing but wipe disks. It has no music player software or anything- all it does is look at whatever disks are plugged into the player and wipes them. It will format <i>both</i> disk drives if you have them both plugged into the player. You need to be completely clear on how it works before going any further. Please read the following warning carefully:<BR><BR>

<center><table border=0 cellpadding = 23 BACKGROUND="modules/Drive_Upgrade/warnbox1.gif" width= 340 height=180><TR><TD><center><font face="Arial, Helv, Helvetica" class=size2 size=2>
<B>WARNING:</B><BR></center>
The Disk Builder upgrade goes into the player's flash RAM and will remain there until a regular upgrade is re-applied. While it's in the flash RAM, any disks plugged into the player will be instantly formatted. If you value the contents of a drive, do not plug it into the player until after you have applied a regular (non-builder) upgrade.</font></TD></TR></table></center><BR>

</font><font size="2" face="Verdana, Arial, Helv, Helvetica">

Okay, got that? Good. If not, read it again.<BR><BR>

Now get Hyperterminal prepared to monitor the serial output from the player. Complete instructions for this are located in the <a href="FAQ/7.html" target=_new>Customization section of the FAQ</a>. You should already have an ".ht" file prepared and ready on the Windows desktop. Make sure it's ready to click on a moment's notice.<BR><BR>

<img src="modules/Drive_Upgrade/drive_12.gif" border=0 align=right vspace=5 hspace=10>All set? <b><i>First step: make sure the power cord to the player is unplugged right now.</b></i> Okay, now apply the Disk Builder upgrade, the one you downloaded as instructed at the beginning of this document. Just double-clicking on the .upgrade file should be all that it takes to launch the upgrade wizard and begin prompting you through the process. (If double-clicking on the .upgrade file produces a box asking you which application to run, then you don't have emplode installed. Re-install emplode and start over again.) Do not apply power to the player until it specifically prompts you to do so. <b><i>When prompted, apply power to the player.</b></i><BR><BR>

If, when you apply the power, the player sits there looking "dead" instead of booting, don't panic. You probably just plugged the IDE cable in wrong. Triple-check the IDE cable and make sure it isn't plugged in backwards, or "off by one pin".<BR><BR>

If the player boots when you apply the power, but you get a "pump" error from the builder, please see <a href="FAQ/8/41.html#41">the FAQ entry about pump errors</a>.<BR><BR>

When you apply power to the player, it should begin upgrading. What it's doing is putting the formatter code into flash RAM. As soon as it's done, the player will reboot and it will begin formatting your disk.<BR><BR>

The instant that the upgrade has been applied, and the wizard is finished, run that Hyperterminal profile. Quickly! When the player reboots after the upgrade, you will see it reboot and it will start formatting the disk. You should see the formatter's output in ASCII on the serial port and on the screen of the player.<br><br>

<blockquote><table border=1 cellpadding=10><tr><td>
If the disk drive wasn't blank, the formatter may complain by saying 'disk is already built'. If this happens, you must prune the "fids" folder from the disk and apply the builder image again from scratch. Here is how to do that:<BR><BR>

While still in Hyperterminal, get to a shell prompt. There's a chance that you might already be sitting at a shell prompt. If not, press ctrl-C and it should drop you to a shell. If not, see if sending a break command works (should be somewhere on the terminal program's menus).<br><br>

type <font color=blue><B>rwm</b></font> (then press enter and wait a while for a shell prompt to appear)<br><br>

type <font color=blue><B>rm -r /drive0/fids</b></font> (then press enter)<br><br>

type <font color=blue><B>rom</b></font> (then press enter)<br><br>

If everything worked, then pull the player's power, close Hyperterminal, and restart the procedure as described above, applying the builder image and launching Hyperterminal as soon as it's been applied, to make sure it didn't stall again a second time.
</td></tr></table></blockquote><br><br>

Eventually, it will complete the formatting of the disk. If you're using a factory builder, it will start a disk stress-testing loop at this point. (Note: Mark Lord's Bigdisk Builder does not do a stress testing loop.) If you are at all concerned about the reliability of the disk drive, you should let this stress test run for quite a while- at least a couple of hours. Although this isn't required (you can terminate the stress test at any time simply by unplugging the power), it's a good idea. The player's screen will eventually go blank during the stress test, you can wake up the screen by pressing a front-panel button (there will be a pause before the screen appears). Note that if you are formatting two disks at the same time, it will only stress test the first disk drive. If you want to stress test the second disk, you must swap it into the primary drive slot and run the factory builder again. When you're satisfied that the disk has been stress tested enough, exit Hyperterminal and remove the power cable from the player.<BR><BR>

<B><I>Important:</b></i> With the new drive still plugged in, apply the standard developer upgrade of the player software (but see the special note for large disks, below). You know, the one that you had ready ahead of time. You should do this even if the drive is only intended as a secondary drive. The reasons are multifold: To prevent the kernel from trying to fry the old disk when you reattach it in the next step, to make sure all the folders are in their proper places, and to let the drive work as a "backup" drive should the primary drive fail. If you are formatting two fresh, blank disks, you should install the the developer build onto both of them (by swapping them into the primary drive slot and applying the upgrade individually).<BR><BR>

Assuming that the developer upgrade worked, the new disk drive is now a fully functional boot disk, with player software and everything. It is also safe to plug in the old drive again because you've just overwritten the Disk Builder kernel in the flash RAM.<BR><BR>

Note that the next time you apply power to the player, if you have the old and new disk drives plugged in at the same time, you may get an error message similar to "Database size mismatch" and the player will attempt to rebuild its database. This will be corrected later, just continue with the instructions and don't be alarmed at the error message.<br><br>

<B><I>Special note for large drives:</b></i> You might run into a problem if your disk drive is larger than about 40-60 gigabytes. The official empeg builder image hasn't been updated to support large disks. It sometimes runs out of memory when building the music partition. This will manifest itself as disk drive errors when the player boots or when you try to put music onto the player. If this happens, there are a few things you can try: You can use <a href="http://rtr.ca/bigdisk">Mark Lord's Special Disk Builder for large disks</a>. You can try to apply the builder image a second time (starting the procedure from the top). Sometimes this is enough. You can also <a href="http://www.differentpla.net/content/2004/03/partition-empeg">partition</a> and <a href="http://www.differentpla.net/content/2004/03/format-empeg">format</a> the hard disk manually. If your disk is larger than 128 gigabytes, make sure to install the latest <a href="http://www.riocar.org/modules.php?op=modload&name=FAQ&file=index&myfaq=yes&id_cat=11&categories=Hijack+Kernel+Questions">Hijack Kernel</a> before partitioning and formatting manually. You will also need to re-install the latest Hijack Kernel after installing the player software onto the player.<br><br>

<B><I>Additional note for drives larger than 160 GB:</b></i> The official empeg upgrader will corrupt the disk if it's 160 gigabytes or larger. Use <a href="http://rtr.ca/bigdisk">2.01 Final Software Installer for Large Disks</a>, instead. If you have a Mk1 player and you're trying to do a 160 gig disk... at the time of this writing I don't think there's a solution for you.<br><br>

<BR><B><I>Step 7: Copying files (special circumstances only)</B></I><BR><BR>

If you need to move the music from one drive to another, you'll need to copy all of the files in the "fids" directory. You don't need to do this if you're simply adding a second disk drive. Skip ahead to the next section if you're simply adding a blank second disk drive.<BR><BR>

There are several scenarios where you might want to copy the music to another drive, but I will give step-by-step instructions here for just one scenario: The complete replacement of the primary disk drive. If you understand what's being done here, you probably will have enough information to handle the other possible situations that might arise. For example, if you are replacing both drives instead of just one drive, repeat the entire procedure to copy the files from the old secondary drive to the new secondary drive.

<UL><LI>After formatting the new drive and installing the developer version of the player software onto it, leave it plugged into the primary drive spot.</LI><BR><BR>

<LI>If you have large disk drives (larger than 128 gigabytes or so), re-install the latest Hijack Kernel</li><br><br>

<LI>Remove the power from the player.</LI><BR><BR>

<LI>Plug the old drive into the secondary spot (setting master/slave jumpers as necessary if it's a Mark 2 player, or using the second IDE header and second cable if it's a Mark 1).</LI><BR><BR>

<LI>Launch your Hyperterminal profile.</LI><BR><BR>

<LI>Apply power to the player and watch it boot in Hyperterminal. Make sure it detects both disk drives correctly.</LI><BR><BR>

<LI>Via Hyperterminal, Press <font color=blue><B>q</b></font> <font class=size1 size=1><b>(Enter)</b></font> to drop to the shell prompt.</LI><BR><BR>

<LI>Read-write mount the disk drives. Type:<BR>
&nbsp&nbsp&nbsp<font color=blue><B>rw</b></font>&nbsp&nbsp&nbsp<font class=size1 size=1><b>(Enter)</b></font><br>
&nbsp&nbsp&nbsp<font color=blue><B>rwm</b></font>&nbsp&nbsp&nbsp<font class=size1 size=1><b>(Enter)</b></font><br>
There will probably be a pause before the shell prompt appears again.</LI><BR><BR>

<LI>Copy the files from the second drive to the first drive:<br>
&nbsp&nbsp&nbsp<font color=blue><B>cp -auvfx /drive1/fids /drive0/ </b></font>&nbsp&nbsp&nbsp<font class=size1 size=1><b>(Enter)</b></font></LI><BR><BR>

<LI>Depending on the drives and the amount of data, it might take a surprisingly long time to complete the copy operation. Be prepared for a long wait. Some users have reported that it can take hours.</LI><BR><BR>

<LI>When it's done, read-only mount the disk drives. Type:<BR>
&nbsp&nbsp&nbsp<font color=blue><B>ro</b></font>&nbsp&nbsp&nbsp<font class=size1 size=1><b>(Enter)</b></font><br>
&nbsp&nbsp&nbsp<font color=blue><B>rom</b></font>&nbsp&nbsp&nbsp<font class=size1 size=1><b>(Enter)</b></font></LI><BR><BR>

<LI>Log out of the shell and drop back to the player software: &nbsp&nbsp&nbsp<font color=blue><B>logout</b></font>&nbsp&nbsp&nbsp<font class=size1 size=1><b>(Enter)</b></font></LI><BR><BR>

<LI>Close Hyperterminal. Unplug the power cable and remove the old drive (or put it on the primary controller and format it if you like- but don't forget to re-install a safe bootable kernel/player to it).</LI><BR><BR>

<LI>If desired, you can copy information from your old second drive onto the new drive. For example, if you are replacing two 10 gig drives with a single 40 gig drive (intending to discard or sell both of the 10s and use only the 40), then you can copy the FIDs from both of the 10 gig drives onto the 40 and it will work. As long as the two 10 gig drives came from the same player, there should not be any file conflicts because the FIDs are designed to be unique within each player's database. This won't work to combine the music from a different player, though. If you want to merge the music from two different players, you have to do it the <a href="http://www.riocar.org/modules.php?op=modload&name=FAQ&file=index&myfaq=yes&id_cat=4&categories=Software+and+player+operation+questions&faqent=18#18" target=_top>old-fashioned way</a>.</LI><BR><BR>

<LI>When you're done copying and formatting, re-assemble the player per the assembly instructions in the next section.</LI><BR><BR>

<LI>Use Emplode to perform a couple of synchronizations. It may require a few player reboots and/or re-synchs with Emplode before the player rebuilds its database properly and the music appears correctly in the list.</LI></UL>

Another thing that might come up is that you might want to copy the dynamic data partition between two disk drives. The master disk drive contains a special partition which stores the following information:<br>
<ul>
<li>The current song running order.</li><br>
<li>Any stored bookmarks.</li><br>
<li>EQ and Tuner presets.</li><br>
<li>Dynamic data about each song, such as the number of times played and the last time played.</li>
</ul>

If you need to preserve this information, use the "dd" command at the shell prompt to copy this partition:<br>

<ul>
<font color=blue><B>dd if=/dev/hda3 of=/dev/hdc3</b></font>&nbsp&nbsp<font class=size1 size=1><b>(Enter)</b></font><br>
to copy from master to slave, or<br><br>
<font color=blue><B>dd if=/dev/hdc3 of=/dev/hda3 </b></font>&nbsp&nbsp<font class=size1 size=1><b>(Enter)</b></font><br>to copy from slave to master.</ul>

If desired, you can also copy the player configuration file "config.ini" from the old drive to the new drive. This file stores information from the "configure player" screen in Emplode. Because most of the information could simply be re-entered in Emplode, copying this file is not always necessary. The information stored in this file includes:<br>
<ul>
<li>The owner's name and phone number.</li><br>
<li>Details of the Wendy filters and the favorite visuals.</li><br>
<li>Ethernet network configuration.</li><br>
<li>Configuration information for certain third-pary software such as the Hijack kernel.</li>
</ul>

If you want to copy this information, first, set the drives to read-write with the <font color=blue><B>rwm</b></font> command as described above, then use the "cp" command at the shell prompt to copy this file:<br>

<ul>
<font color=blue><B>cp /drive0/var/config.ini /drive1/var/config.ini</b></font>&nbsp&nbsp<font class=size1 size=1><b>(Enter)</b></font><br>
to copy from master to slave, or<br><br>
<font color=blue><B>cp /drive1/var/config.ini /drive0/var/config.ini</b></font>&nbsp&nbsp<font class=size1 size=1><b>(Enter)</b></font><br>to copy from slave to master.</ul>

Don't forget to set the drives back to read-only with the <font color=blue><B>rom</b></font> command when you're done.<br><br>
 

<BR><B><I>Step 8: Putting it back together</B></I><BR><BR>

If you're just adding a second drive, all you need to do now is put the new disk onto the secondary controller (or the slave spot if it's a Mark 2- check the drive's docs for the proper jumper settings), put the old disk back onto the primary controller, and put it all back together. As they say in the automotive manuals, "Installation is the reverse of removal."<BR><BR>

Make sure to orient all of the items (drives, trays, IDE cables, etc.) the same directions that you noted when you took it all apart. If the tray is backwards, or the drives are not facing the correct direction on the tray, you'll have problems.<br><br>

<table border=0 cellpadding=5 ><TR><TD valign=top><img src="modules/Drive_Upgrade/mark2.gif" border=0 alt="Mark 2" ></td><td valign=top><font size="2" face="Verdana, Arial, Helv, Helvetica">

<img src="modules/Drive_Upgrade/drive_13.jpg" border=0 align=right vspace=5 hspace=10>If you have added a jumper to the secondary disk drive, make sure that the jumper is well-secured. Some users have reported that the jumpers can come loose from the pins after a period of time, which causes the player to stop booting. There are several ways you can go about securing the jumper, including carefully bending the pins, using a dab of hot-melt glue, or covering it with electrical tape.
</FONT></TD></TR></TABLE><br>

</font><font size="2" face="Verdana, Arial, Helv, Helvetica">

Remember the washers I told you about at the beginning of this guide? Use them now, when re-assembling, to stand the disk drives off from the cradle. Although this might not strictly be required for your particular brand of drive, it adds a good measure of safety in all cases.

<blockquote><font class=size1 size=1><i>Note:</i> It has been reported that the drive mounting screws can work loose on some players, causing serious problems if the screw contacts certain components on the motherboard. When screwing the drives to the cradle, tighten them securely and use either threadlock compound or a dab of hot-melt glue to make sure they stay in place if possible.</font></blockquote>

<B><I>Optional:</b></I> If you think it's important, use a small dab of hot-melt glue to secure the IDE cables in place on the drives. This is entirely dependent on just how rough you intend to be with the player, and if you don't mind opening the player again to re-seat the cable if it comes off. Personally, I prefer to go without any glue, because the hassle of re-seating the cable once is a blue moon is nothing compared to the hassle of picking off that nasty glue when I want to upgrade my disks. If you decide you need to do the glue, <a href="upload/faqpics/glue_drive_cable.mpg">here is a movie (4.5mb mpeg)</a> of the procedure.<BR><BR>

Putting the cradle back in place should be fairly simple on the Mark 2, and just a bit tricky on the Mark 1.<BR><BR>

<table border=0 cellpadding=5 ><TR><TD valign=top><img src="modules/Drive_Upgrade/mark1.gif" border=0 alt="Mark 1" ></td><td valign=top><font size="2" face="Verdana, Arial, Helv, Helvetica">

The Mark 1 has less space and more "sticking out" components than the Mark 2 does. Most notably, the frontmost edge of the disk drives tend to want to bump up against the display board, and this is a Bad Thing. So be very careful.<BR><BR>

In my case, the secondary IDE cable's connector was interfering with a component on the display board, and I actually had to file down the corner of the plastic connector to make sure there was enough clearance so that it wouldn't bump the component when the cradle moved.<BR><BR>

Also, as the cradle is inserted, check to make sure that the secondary IDE cable does not interfere with the sub-boards that rise above the motherboard in the back of the unit. You may have to deliberately crease the secondary IDE cable so that it sits nicely beneath the cradle without bumping these boards.
</FONT></TD></TR></TABLE><BR>

</font><font size="2" face="Verdana, Arial, Helv, Helvetica">

Whatever you do, be careful not to force anything when re-assembling the unit. Everything should be done gently and carefully. If you encounter resistance, search for the source of the resistance before going any further.<BR><BR>

Check the movement of the shock-mount tray after installing it and screwing it down. Make sure it has the correct travel so that it can do its job without bumping into other components in the case.<BR><BR>

<B><I>Optional:</b></i> After you've checked the shock-mount travel and it's all OK, you might want to re-do the screws that hold the tray assembly to the sides of the case, this time with thread-lock compound.<BR><BR>

Replace the top lid.<BR><BR>

<table border=0 cellpadding=5 ><TR><TD valign=top><img src="modules/Drive_Upgrade/mark2.gif" border=0 alt="Mark 2" ></td><td valign=top><font size="2" face="Verdana, Arial, Helv, Helvetica">

If you've got a Mark 2, replace the lens, buttons, fascia, and knob. Make sure the buttons go back on in the same way they came off. The left and right buttons are unique, make sure they go on in the proper direction.<BR><BR>

When you screw the faceplate back on, don't overtighten the screws. They should be just tight enough to hold the face on. If they are too tight, they will cause the buttons to stick. On my Mark 2, I am able to tighten the bolts pretty tight, but I have to carefully adjust the position of the fascia before I do it. Some practice and trial-and-error may be involved.</FONT></TD></TR></TABLE><BR>

</font><font size="2" face="Verdana, Arial, Helv, Helvetica">

Now boot up your player with Hyperterminal running, and check to make sure both drives are found during the boot process.<BR><BR>

If all is well, exit Hyperterminal and run Emplode. After a couple of synchs, it should be able to fully rebuild its database, and you should see the new capacity in the lower-right corner of the window.<BR><BR>

You're done!<br><br><br><br><br>


</font>

</td></tr></table>
</td></tr></table>

</td></tr></table>
    <center><font class=tiny>

    <table border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#666666" height="20">
  <tr>
    <td width="100%" align="center">
    <font color="#ffffff" face="Verdana" size="2"><b>Copyright &copy; 2001-2018  riocar.org<BR>

    </b>All logos and trademarks on this site are property of their respective owners. The comments are property of their posters.</font></td>
  </tr>
</table>

    </font></center>

    
    </body>

    </html>